/*! For license information please see 599.js.LICENSE.txt */
"use strict";(self.webpackChunkmetavox=self.webpackChunkmetavox||[]).push([[599],{54297:(t,e,n)=>{n.d(e,{A:()=>l});var a=n(31601),r=n.n(a),i=n(76314),o=n.n(i)()(r());o.push([t.id,"\n.bulk-metadata-modal[data-v-44ba9925] {\n\tpadding: 16px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 12px;\n\tmax-height: 70vh;\n\toverflow-y: auto;\n}\n.modal-header[data-v-44ba9925] {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n.modal-title[data-v-44ba9925] {\n\tmargin: 0;\n\tfont-size: 18px;\n\tfont-weight: 600;\n}\n.file-count[data-v-44ba9925] {\n\tfont-size: 13px;\n\tcolor: var(--color-text-maxcontrast);\n\tbackground: var(--color-background-dark);\n\tpadding: 2px 8px;\n\tborder-radius: 10px;\n}\n.selected-files[data-v-44ba9925] {\n\tborder: 1px solid var(--color-border);\n\tborder-radius: var(--border-radius);\n\toverflow: hidden;\n}\n.files-toggle[data-v-44ba9925] {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 4px;\n\twidth: 100%;\n\tpadding: 8px 10px;\n\tbackground: var(--color-background-hover);\n\tborder: none;\n\tcursor: pointer;\n\tfont-size: 13px;\n\tfont-weight: 500;\n\tcolor: var(--color-main-text);\n\ttext-align: left;\n}\n.files-toggle[data-v-44ba9925]:hover {\n\tbackground: var(--color-background-dark);\n}\n.file-list[data-v-44ba9925] {\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 4px 10px 8px;\n\tmax-height: 100px;\n\toverflow-y: auto;\n\tbackground: var(--color-main-background);\n}\n.file-item[data-v-44ba9925] {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 6px;\n\tpadding: 2px 0;\n\tfont-size: 12px;\n}\n.file-name[data-v-44ba9925] {\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n\tflex: 1;\n}\n.merge-strategy[data-v-44ba9925] {\n\tdisplay: flex;\n\tgap: 16px;\n\tpadding: 8px 0;\n\tborder-bottom: 1px solid var(--color-border);\n}\n.loading-state[data-v-44ba9925] {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tgap: 8px;\n\tpadding: 24px;\n\tcolor: var(--color-text-maxcontrast);\n}\n.metadata-section[data-v-44ba9925] {\n\tflex: 1;\n\tmin-height: 0;\n\toverflow-y: auto;\n}\n.no-fields[data-v-44ba9925] {\n\tpadding: 16px;\n\ttext-align: center;\n\tcolor: var(--color-text-maxcontrast);\n\tfont-size: 13px;\n}\n.modal-actions[data-v-44ba9925] {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tgap: 8px;\n\tpadding-top: 12px;\n\tborder-top: 1px solid var(--color-border);\n}\n.actions-left[data-v-44ba9925] {\n\tdisplay: flex;\n\tgap: 6px;\n}\n.actions-right[data-v-44ba9925] {\n\tdisplay: flex;\n\tgap: 6px;\n}\n",""]);const l=o},54599:(t,e,n)=>{n.r(e),n.d(e,{default:()=>W});var a=function(){var t=this,e=t._self._c;return t.show?e("NcModal",{attrs:{name:t.t("metavox","Edit Metadata"),size:"normal"},on:{close:t.close}},[e("div",{staticClass:"bulk-metadata-modal"},[e("div",{staticClass:"modal-header"},[e("h2",{staticClass:"modal-title"},[t._v("\n\t\t\t\t"+t._s(t.t("metavox","Edit Metadata"))+"\n\t\t\t")]),t._v(" "),e("span",{staticClass:"file-count"},[t._v(t._s(t.files.length)+" "+t._s(1===t.files.length?"file":"files"))])]),t._v(" "),e("div",{staticClass:"selected-files",class:{expanded:t.showFileList}},[e("button",{staticClass:"files-toggle",attrs:{type:"button"},on:{click:function(e){t.showFileList=!t.showFileList}}},[t.showFileList?e("ChevronDownIcon",{attrs:{size:20}}):e("ChevronRightIcon",{attrs:{size:20}}),t._v(" "),e("span",[t._v(t._s(t.t("metavox","Selected Files")))])],1),t._v(" "),t.showFileList?e("ul",{staticClass:"file-list"},t._l(t.files,function(n){return e("li",{key:n.fileid,staticClass:"file-item"},[e("FileIcon",{attrs:{size:16}}),t._v(" "),e("span",{staticClass:"file-name"},[t._v(t._s(n.basename))])],1)}),0):t._e()]),t._v(" "),e("div",{staticClass:"merge-strategy"},[e("NcCheckboxRadioSwitch",{attrs:{checked:"overwrite"===t.mergeStrategy,type:"radio",name:"merge-strategy"},on:{"update:checked":function(e){t.mergeStrategy="overwrite"}}},[t._v("\n\t\t\t\t"+t._s(t.t("metavox","Overwrite existing values"))+"\n\t\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{checked:"fill-empty"===t.mergeStrategy,type:"radio",name:"merge-strategy"},on:{"update:checked":function(e){t.mergeStrategy="fill-empty"}}},[t._v("\n\t\t\t\t"+t._s(t.t("metavox","Only fill empty fields"))+"\n\t\t\t")])],1),t._v(" "),t.loading?e("div",{staticClass:"loading-state"},[e("NcLoadingIcon",{attrs:{size:32}}),t._v(" "),e("p",[t._v(t._s(t.t("metavox","Loading metadata fields...")))])],1):t.fields.length>0?e("div",{staticClass:"metadata-section"},[e("MetadataForm",{attrs:{fields:t.fields,values:t.metadata,"select-values":t.selectValues,"multi-select-values":t.multiSelectValues,"select-key":t.selectKey},on:{update:t.handleFieldUpdate}})],1):e("div",{staticClass:"no-fields"},[e("p",[t._v(t._s(t.t("metavox","No metadata fields available for these files.")))])]),t._v(" "),e("div",{staticClass:"modal-actions"},[e("div",{staticClass:"actions-left"},[e("NcButton",{attrs:{type:"error",disabled:t.clearing||0===t.fields.length},on:{click:t.confirmClearAll},scopedSlots:t._u([{key:"icon",fn:function(){return[t.clearing?e("NcLoadingIcon",{attrs:{size:20}}):e("DeleteIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,958716465)},[t._v("\n\t\t\t\t\t"+t._s(t.clearing?t.t("metavox","Clearing..."):t.t("metavox","Clear All"))+"\n\t\t\t\t")]),t._v(" "),e("NcButton",{attrs:{type:"secondary",disabled:t.exporting||0===t.fields.length},on:{click:t.exportToCsv},scopedSlots:t._u([{key:"icon",fn:function(){return[t.exporting?e("NcLoadingIcon",{attrs:{size:20}}):e("DownloadIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1701634945)},[t._v("\n\t\t\t\t\t"+t._s(t.exporting?t.t("metavox","Exporting..."):t.t("metavox","Export CSV"))+"\n\t\t\t\t")])],1),t._v(" "),e("div",{staticClass:"actions-right"},[e("NcButton",{attrs:{type:"tertiary"},on:{click:t.close}},[t._v("\n\t\t\t\t\t"+t._s(t.t("metavox","Cancel"))+"\n\t\t\t\t")]),t._v(" "),e("NcButton",{attrs:{type:"primary",disabled:t.saving||!t.hasChanges},on:{click:t.save},scopedSlots:t._u([{key:"icon",fn:function(){return[t.saving?e("NcLoadingIcon",{attrs:{size:20}}):t._e()]},proxy:!0}],null,!1,177630579)},[t._v("\n\t\t\t\t\t"+t._s(t.saving?t.t("metavox","Saving..."):t.t("metavox","Save"))+"\n\t\t\t\t")])],1)])])]):t._e()};a._withStripped=!0;var r=n(76333),i=n(93106),o=n(66802),l=n(63814),s=n(99788),c=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon delete-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};c._withStripped=!0;const u={name:"DeleteIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var d=n(14486);const f=(0,d.A)(u,c,[],!1,null,null,null).exports;var p=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon download-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};p._withStripped=!0;const v={name:"DownloadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},m=(0,d.A)(v,p,[],!1,null,null,null).exports;var g=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon chevron-right-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};g._withStripped=!0;const h={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},y=(0,d.A)(h,g,[],!1,null,null,null).exports;var b=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon chevron-down-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};b._withStripped=!0;const x={name:"ChevronDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},_=(0,d.A)(x,b,[],!1,null,null,null).exports;var w=n(48753);function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function S(t){return function(t){if(Array.isArray(t))return F(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach(function(e){A(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function A(t,e,n){return(e=function(t){var e=function(t){if("object"!=k(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==k(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j(){var t,e,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,a,r,i){var s=a&&a.prototype instanceof l?a:l,c=Object.create(s.prototype);return I(c,"_invoke",function(n,a,r){var i,l,s,c=0,u=r||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return i=e,l=0,s=t,f.n=n,o}};function p(n,a){for(l=n,s=a,e=0;!d&&c&&!r&&e<u.length;e++){var r,i=u[e],p=f.p,v=i[2];n>3?(r=v===a)&&(s=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=t):i[0]<=p&&((r=n<2&&p<i[1])?(l=0,f.v=a,f.n=i[1]):p<v&&(r=n<3||i[0]>a||a>v)&&(i[4]=n,i[5]=a,f.n=v,l=0))}if(r||n>1)return o;throw d=!0,a}return function(r,u,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),l=u,s=v;(e=l<2?t:s)||!d;){i||(l?l<3?(l>1&&(f.n=-1),p(l,s)):f.n=s:f.v=s);try{if(c=2,i){if(l||(r="next"),e=i[r]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,l<2&&(l=0)}else 1===l&&(e=i.return)&&e.call(i),l<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),l=1);i=t}else if((e=(d=f.n<0)?s:n.call(a,f))!==o)break}catch(e){i=t,l=1,s=e}finally{c=1}}return{value:e,done:d}}}(n,r,i),!0),c}var o={};function l(){}function s(){}function c(){}e=Object.getPrototypeOf;var u=[][a]?e(e([][a]())):(I(e={},a,function(){return this}),e),d=c.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,I(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=c,I(d,"constructor",c),I(c,"constructor",s),s.displayName="GeneratorFunction",I(c,r,"GeneratorFunction"),I(d),I(d,r,"Generator"),I(d,a,function(){return this}),I(d,"toString",function(){return"[object Generator]"}),(j=function(){return{w:i,m:f}})()}function I(t,e,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}I=function(t,e,n,a){function i(e,n){I(t,e,function(t){return this._invoke(e,n,t)})}e?r?r(t,e,{value:n,enumerable:!a,configurable:!a,writable:!a}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},I(t,e,n,a)}function L(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=z(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function z(t,e){if(t){if("string"==typeof t)return F(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(t,e):void 0}}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function N(t,e,n,a,r,i,o){try{var l=t[i](o),s=l.value}catch(t){return void n(t)}l.done?e(s):Promise.resolve(s).then(a,r)}function M(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){N(i,a,r,o,l,"next",t)}function l(t){N(i,a,r,o,l,"throw",t)}o(void 0)})}}const E={name:"BulkMetadataModal",components:{NcModal:r.FH,NcButton:r.x1,NcCheckboxRadioSwitch:r.AO,NcLoadingIcon:r.ne,FileIcon:s.A,DeleteIcon:f,DownloadIcon:m,ChevronRightIcon:y,ChevronDownIcon:_,MetadataForm:w.A},props:{show:{type:Boolean,default:!1},files:{type:Array,default:function(){return[]}}},emits:["close","saved"],data:function(){return{loading:!1,saving:!1,clearing:!1,exporting:!1,fields:[],metadata:{},originalMetadata:{},mergeStrategy:"overwrite",selectValues:{},multiSelectValues:{},selectKey:0,showFileList:!1}},computed:{hasChanges:function(){return JSON.stringify(this.metadata)!==JSON.stringify(this.originalMetadata)}},watch:{show:{immediate:!0,handler:function(t){t&&this.files.length>0&&this.loadFields()}}},methods:{t:function(t,e,n){if(n){var a=window.t?window.t(t,e):e;return Object.keys(n).forEach(function(t){a=a.replace("{".concat(t,"}"),n[t])}),a}return window.t?window.t(t,e):e},loadFields:function(){var t=this;return M(j().m(function e(){var n,a,r,s,c,u,d,f,p,v,m,g,h;return j().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.loading=!0,e.p=1,n=t.files[0],a=n.path||n.filename||"",r=a.match(/^\/__groupfolders\/(\d+)/),s=null,!r){e.n=2;break}s=r[1],e.n=10;break;case 2:return e.n=3,o.Ay.get((0,l.Jv)("/apps/metavox/api/groupfolders"));case 3:c=e.v,u=c.data,d=L(u),e.p=4,d.s();case 5:if((f=d.n()).done){e.n=7;break}if(p=f.value,!a.includes("/".concat(p.mount_point,"/"))&&!a.startsWith("/".concat(p.mount_point))){e.n=6;break}return s=p.id,e.a(3,7);case 6:e.n=5;break;case 7:e.n=9;break;case 8:e.p=8,g=e.v,d.e(g);case 9:return e.p=9,d.f(),e.f(9);case 10:if(!s){e.n=12;break}return v=t.files[0].fileid,e.n=11,o.Ay.get((0,l.Jv)("/apps/metavox/api/groupfolders/{groupfolderId}/files/{fileId}/metadata",{groupfolderId:s,fileId:v}));case 11:m=e.v,t.fields=(m.data||[]).filter(function(t){var e=t.applies_to_groupfolder;return 0===e||"0"===e||null==e}),e.n=13;break;case 12:t.fields=[];case 13:t.metadata={},t.originalMetadata={},t.fields.forEach(function(e){t.metadata[e.field_name]="",t.originalMetadata[e.field_name]=""}),t.initializeSelectValues(),e.n=15;break;case 14:e.p=14,h=e.v,console.error("Failed to load fields:",h),(0,i.Qg)(t.t("metavox","Failed to load metadata fields"));case 15:return e.p=15,t.loading=!1,e.f(15);case 16:return e.a(2)}},e,null,[[4,8,9,10],[1,14,15,16]])}))()},initializeSelectValues:function(){var t=this;this.selectValues={},this.multiSelectValues={},this.fields.forEach(function(e){"select"===e.field_type?t.selectValues[e.field_name]=null:"multiselect"!==e.field_type&&"multi_select"!==e.field_type||(t.multiSelectValues[e.field_name]=[])}),this.selectKey++},handleFieldUpdate:function(t,e){this.metadata=O(O({},this.metadata),{},A({},t,e));var n=this.fields.find(function(e){return e.field_name===t});n&&("select"===n.field_type?this.selectValues[t]=e||null:"multiselect"!==n.field_type&&"multi_select"!==n.field_type||(this.multiSelectValues[t]=e?e.split(";#"):[]))},save:function(){var t=this;return M(j().m(function e(){var n,a,r,s;return j().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.saving=!0,e.p=1,n=t.files.map(function(t){return t.fileid}),a={},Object.keys(t.metadata).forEach(function(e){""!==t.metadata[e]&&null!==t.metadata[e]&&(a[e]=t.metadata[e])}),0!==Object.keys(a).length){e.n=2;break}return(0,i.Qg)(t.t("metavox","No metadata values to save")),e.a(2);case 2:return e.n=3,o.Ay.post((0,l.Jv)("/apps/metavox/api/files/bulk-metadata"),{fileIds:n,metadata:a,mergeStrategy:t.mergeStrategy});case 3:(0,i.Te)(t.t("metavox","Metadata saved for {count} files",{count:t.files.length})),t.$emit("saved"),t.close(),e.n=5;break;case 4:e.p=4,s=e.v,console.error("Failed to save metadata:",s),(0,i.Qg)((null===(r=s.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.error)||t.t("metavox","Failed to save metadata"));case 5:return e.p=5,t.saving=!1,e.f(5);case 6:return e.a(2)}},e,null,[[1,4,5,6]])}))()},close:function(){this.metadata={},this.originalMetadata={},this.fields=[],this.$emit("close")},confirmClearAll:function(){var t=this;return M(j().m(function e(){return j().w(function(e){for(;;)switch(e.n){case 0:if(confirm(t.t("metavox","Are you sure you want to clear all metadata from {count} files? This cannot be undone.",{count:t.files.length}))){e.n=1;break}return e.a(2);case 1:return e.n=2,t.clearAllMetadata();case 2:return e.a(2)}},e)}))()},clearAllMetadata:function(){var t=this;return M(j().m(function e(){var n,a,r;return j().w(function(e){for(;;)switch(e.p=e.n){case 0:return t.clearing=!0,e.p=1,n=t.files.map(function(t){return t.fileid}),e.n=2,o.Ay.post((0,l.Jv)("/apps/metavox/api/files/clear-metadata"),{fileIds:n});case 2:(0,i.Te)(t.t("metavox","Metadata cleared for {count} files",{count:t.files.length})),t.$emit("saved"),t.close(),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Failed to clear metadata:",r),(0,i.Qg)((null===(a=r.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.error)||t.t("metavox","Failed to clear metadata"));case 4:return e.p=4,t.clearing=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))()},exportToCsv:function(){var t=this;return M(j().m(function e(){var n,a,r,s,c,u,d,f,p,v,m,g;return j().w(function(e){for(;;)switch(e.p=e.n){case 0:return t.exporting=!0,e.p=1,n=t.files.map(function(t){return t.fileid}),e.n=2,o.Ay.post((0,l.Jv)("/apps/metavox/api/files/export-metadata"),{fileIds:n});case 2:if(a=e.v,(r=a.data)&&0!==r.length){e.n=3;break}return(0,i.Qg)(t.t("metavox","No metadata to export")),e.a(2);case 3:s=["File Path","File Name"].concat(S(t.fields.map(function(t){return t.field_label||t.field_name}))),c=r.map(function(e){var n=[e.path,e.name];return t.fields.forEach(function(t){n.push(e.metadata[t.field_name]||"")}),n}),u=function(t){if(null==t)return"";var e=String(t);return e.includes(",")||e.includes('"')||e.includes("\n")?'"'+e.replace(/"/g,'""')+'"':e},d=[s.map(u).join(",")].concat(S(c.map(function(t){return t.map(u).join(",")}))).join("\n"),f=new Blob([d],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(f),(v=document.createElement("a")).href=p,v.download="metadata-export-".concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(p),(0,i.Te)(t.t("metavox","Metadata exported for {count} files",{count:t.files.length})),e.n=5;break;case 4:e.p=4,g=e.v,console.error("Failed to export metadata:",g),(0,i.Qg)((null===(m=g.response)||void 0===m||null===(m=m.data)||void 0===m?void 0:m.error)||t.t("metavox","Failed to export metadata"));case 5:return e.p=5,t.exporting=!1,e.f(5);case 6:return e.a(2)}},e,null,[[1,4,5,6]])}))()}}};var P=n(85072),V=n.n(P),T=n(97825),D=n.n(T),B=n(77659),H=n.n(B),$=n(55056),R=n.n($),J=n(10540),U=n.n(J),G=n(41113),Q=n.n(G),Z=n(54297),K={};K.styleTagTransform=Q(),K.setAttributes=R(),K.insert=H().bind(null,"head"),K.domAPI=D(),K.insertStyleElement=U(),V()(Z.A,K),Z.A&&Z.A.locals&&Z.A.locals;const W=(0,d.A)(E,a,[],!1,null,"44ba9925",null).exports}}]);