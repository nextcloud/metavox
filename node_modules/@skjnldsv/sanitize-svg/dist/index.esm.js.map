{"version":3,"file":"index.esm.js","sources":["../lib/index.ts"],"sourcesContent":["import { Buffer } from 'buffer'\nimport isSvg from 'is-svg'\n\nconst readAsText = (svg: File | Buffer) =>\n\tnew Promise<string | null>((resolve) => {\n\t\tif (!isFile(svg)) {\n\t\t\tresolve(svg.toString('utf-8'))\n\t\t} else {\n\t\t\tconst fileReader = new FileReader()\n\t\t\tfileReader.onload = () => {\n\t\t\t\tresolve(fileReader.result as string | null)\n\t\t\t}\n\t\t\tfileReader.readAsText(svg)\n\t\t}\n\t})\n\nconst isFile = (obj: File | Buffer): obj is File => {\n\treturn (obj as File).size !== undefined\n}\n\nexport const sanitizeSVG = async (svg: Buffer | File | string | null) => {\n\tif (!svg) {\n\t\tthrow new Error('Not an svg')\n\t}\n\n\tlet svgText = ''\n\tif (Buffer.isBuffer(svg) || svg instanceof File) {\n\t\tsvgText = await readAsText(svg) as string\n\t} else {\n\t\tsvgText = svg\n\t}\n\n\tif (!isSvg(svgText)) {\n\t\tthrow new Error('Not an svg')\n\t}\n\n\tconst div = document.createElement('div')\n\tdiv.innerHTML = svgText\n\tconst svgEl = div.firstElementChild!\n\tconst attributes = Array.from(svgEl.attributes).map(({ name }) => name)\n\tconst hasScriptAttr = !!attributes.find((attr) => attr.startsWith('on'))\n\tconst scripts = svgEl.getElementsByTagName('script')\n\n\treturn scripts.length === 0 && !hasScriptAttr ? svg : null\n}\n"],"names":[],"mappings":";;;AAGA,MAAM,UAAU,GAAG,CAAC,GAAkB,KACrC,IAAI,OAAO,CAAgB,CAAC,OAAO,KAAI;AACtC,IAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE;QACjB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAA;AAC9B,KAAA;AAAM,SAAA;AACN,QAAA,MAAM,UAAU,GAAG,IAAI,UAAU,EAAE,CAAA;AACnC,QAAA,UAAU,CAAC,MAAM,GAAG,MAAK;AACxB,YAAA,OAAO,CAAC,UAAU,CAAC,MAAuB,CAAC,CAAA;AAC5C,SAAC,CAAA;AACD,QAAA,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC,CAAA;AAC1B,KAAA;AACF,CAAC,CAAC,CAAA;AAEH,MAAM,MAAM,GAAG,CAAC,GAAkB,KAAiB;AAClD,IAAA,OAAQ,GAAY,CAAC,IAAI,KAAK,SAAS,CAAA;AACxC,CAAC,CAAA;MAEY,WAAW,GAAG,OAAO,GAAkC,KAAI;IACvE,IAAI,CAAC,GAAG,EAAE;AACT,QAAA,MAAM,IAAI,KAAK,CAAC,YAAY,CAAC,CAAA;AAC7B,KAAA;IAED,IAAI,OAAO,GAAG,EAAE,CAAA;IAChB,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,GAAG,YAAY,IAAI,EAAE;AAChD,QAAA,OAAO,GAAG,MAAM,UAAU,CAAC,GAAG,CAAW,CAAA;AACzC,KAAA;AAAM,SAAA;QACN,OAAO,GAAG,GAAG,CAAA;AACb,KAAA;AAED,IAAA,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE;AACpB,QAAA,MAAM,IAAI,KAAK,CAAC,YAAY,CAAC,CAAA;AAC7B,KAAA;IAED,MAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;AACzC,IAAA,GAAG,CAAC,SAAS,GAAG,OAAO,CAAA;AACvB,IAAA,MAAM,KAAK,GAAG,GAAG,CAAC,iBAAkB,CAAA;IACpC,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC,CAAA;IACvE,MAAM,aAAa,GAAG,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAA;IACxE,MAAM,OAAO,GAAG,KAAK,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAA;AAEpD,IAAA,OAAO,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,aAAa,GAAG,GAAG,GAAG,IAAI,CAAA;AAC3D;;;;"}